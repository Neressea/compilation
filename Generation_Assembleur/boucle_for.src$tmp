RESETA 	equ 0xEFDC 	// adresse de lancement
INA    	equ 0xEFA0 	// adresse du port // d'entree
OUTA   	equ 0xEFA2 	// adresse du port // de sortie
LOADA  	equ 0xEFDC      // adresse de chargement
SEUIL	equ 3		// seuil
ORG   LOADA	// chargement en LOADA
START RESETA	// demarre en RESETA
LDW R3, #9
STW R3, -(R15) //On empile la valeur diclarie
LDW R3, #4
STW R3, -(R15) //On empile la valeur diclarie
LDW R3, #2
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #3
LDW R2, (R15)+ //On depile l'operande droite
MUL R2, R3, R3
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R1, #0x0ffe //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
LDW R2, (R15)+ //On depile l'operande droite
SUB R2, R3, R3
STW R3, -(R15) //On empile la valeur diclarie
LDW R3, #0
STW R3, -(R15) //On empile la valeur diclarie
LDW R3, #0
STW R3, -(R15) //On empile la valeur diclarie
LDW R1, #0x0ffc //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #1
LDW R2, (R15)+ //On depile l'operande droite
ADD R2, R3, R3
STW R3, -(R15) //On empile valeur initiale du compteur de boucle
boucle0 //Etiquette de la boucle
LDW R1, #0x0ff8 //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #2
LDW R2, (R15)+ //On depile l'operande droite
ADD R2, R3, R3
LDW R1, #0x0ff8 //On charge l'adresse de l'idf dans R1
STW R3, (R1) //On stocke le resultat dans la mimoire
LDW R1, #0x0ff8 //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #1
LDW R2, (R15)+ //On depile l'operande droite
SUB R2, R3, R3
LDW R1, #0x0ff8 //On charge l'adresse de l'idf dans R1
STW R3, (R1) //On stocke le resultat dans la mimoire
LDW R1, #0x0ffe //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R1, #0x0ffa //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
LDW R2, (R15)+ //On depile l'operande droite
ADD R2, R3, R3
LDW R1, #0x0ff4 //On charge l'adresse de l'idf dans R1
LDW R2, (R1) //On charge le compteur dans R2
SUB R3, R2, R3
BEQ sortie_boucle0-$-2
ADQ 1, R2 //on incrimente le compteur
STW R2, (R1) //On met a jour le compteur en memoire
BMP boucle0-$-2
sortie_boucle0
LDW R3, (R15)+ //on dipile le compteur
LDW R1, #0x0ffc //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R1, #0x0ffa //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
LDW R2, (R15)+ //On depile l'operande droite
SUB R2, R3, R3
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #1
LDW R2, (R15)+ //On depile l'operande droite
ADD R2, R3, R3
STW R3, -(R15) //On empile valeur initiale du compteur de boucle
boucle1 //Etiquette de la boucle
LDW R3, #1
STW R3, -(R15) //On empile valeur initiale du compteur de boucle
boucle2 //Etiquette de la boucle
LDW R1, #0x0ff6 //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #1
LDW R2, (R15)+ //On depile l'operande droite
ADD R2, R3, R3
LDW R1, #0x0ff6 //On charge l'adresse de l'idf dans R1
STW R3, (R1) //On stocke le resultat dans la mimoire
LDW R1, #0x0ffc //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
LDW R1, #0x0ff2 //On charge l'adresse de l'idf dans R1
LDW R2, (R1) //On charge le compteur dans R2
SUB R3, R2, R3
BEQ sortie_boucle2-$-2
ADQ 1, R2 //on incrimente le compteur
STW R2, (R1) //On met a jour le compteur en memoire
BMP boucle2-$-2
sortie_boucle2
LDW R3, (R15)+ //on dipile le compteur
LDW R1, #0x0ffe //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R1, #0x0ffa //On charge l'adresse de l'idf dans R1
LDW R3, (R1)
STW R3, -(R15) //On empile le resultat de l'operande droite
LDW R3, #2
LDW R2, (R15)+ //On depile l'operande droite
DIV R2, R3, R3
LDW R2, (R15)+ //On depile l'operande droite
SUB R2, R3, R3
LDW R1, #0x0ff4 //On charge l'adresse de l'idf dans R1
LDW R2, (R1) //On charge le compteur dans R2
SUB R3, R2, R3
BEQ sortie_boucle1-$-2
ADQ 1, R2 //on incrimente le compteur
STW R2, (R1) //On met a jour le compteur en memoire
BMP boucle1-$-2
sortie_boucle1
LDW R3, (R15)+ //on dipile le compteur
